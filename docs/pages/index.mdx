import { Callout, Steps, Cards } from "nextra/components";
import { useData } from "nextra/data";
import Image from "next/image";
import { Tabs } from "nextra/components";
import { useState, useEffect } from "react";

export function Hero({
  title,
  subtitle,
  ctaText,
  ctaLink,
  ctaText2,
  ctaLink2,
}) {
  const [isHovered1, setIsHovered1] = useState(false);
  const [isHovered2, setIsHovered2] = useState(false);

const buttonStyle = (isHovered) => ({
padding: "0.5rem 1rem",
backgroundColor: isHovered ? "#a52a2a" : "#8b0000",
color: "white",
textDecoration: "none",
borderRadius: "8px",
transition: "all 0.3s ease",
border: "1px solid #333333",
boxShadow: "0 2px 4px rgba(0, 0, 0, 0.1)",
transform: isHovered ? "translateY(-2px)" : "translateY(0)",
});

return (

<div style={{ textAlign: "center" }}>
  <h1 style={{ fontSize: "2.5rem", marginBottom: "1rem" }}>{title}</h1>
  <p style={{ fontSize: "1rem", marginBottom: "2rem" }}>{subtitle}</p>
  <div style={{ display: "flex", justifyContent: "center", gap: "1rem" }}>
    <a
      href={ctaLink}
      style={buttonStyle(isHovered1)}
      onMouseEnter={() => setIsHovered1(true)}
      onMouseLeave={() => setIsHovered1(false)}
    >
      {ctaText}
    </a>
    <a
      href={ctaLink2}
      style={buttonStyle(isHovered2)}
      onMouseEnter={() => setIsHovered2(true)}
      onMouseLeave={() => setIsHovered2(false)}
    >
      {ctaText2}
    </a>
  </div>
</div>
); }

export function AnimatedCode({ code }) {
  const [displayedCode, setDisplayedCode] = useState('');
  const [showCursor, setShowCursor] = useState(true);
  const [showConfirmation, setShowConfirmation] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);

  const getRandomTypingDelay = () => Math.random() * 50 + 20;

  const lineCount = code.split('\n').length;
  const lineHeight = 1.5; // em
  const codeHeight = `${lineCount * lineHeight}em`;
  const terminalHeight = '100px';
  const headerHeight = '40px';
  const componentHeight = `calc(${codeHeight} + ${terminalHeight} + ${headerHeight} - 2em)`;

  // Split the code into fast-forward and normal typing sections
  const fastForwardIndex = code.indexOf('const txHash');
  const fastForwardSection = code.slice(0, fastForwardIndex);
  const normalTypingSection = code.slice(fastForwardIndex);

  useEffect(() => {
    let isMounted = true;

    const animateCode = async () => {
      // Fast-forward section (typing quickly)
      let currentCode = '';
      for (let i = 0; i < fastForwardSection.length; i++) {
        if (!isMounted) break;
        currentCode += fastForwardSection[i];
        setDisplayedCode(currentCode);
        await new Promise(resolve => setTimeout(resolve, 5)); // Very short delay for fast typing
      }

      await new Promise(resolve => setTimeout(resolve, 500)); // Short pause after fast-forward

      // Normal typing section
      for (let i = 0; i < normalTypingSection.length; i++) {
        if (!isMounted) break;
        currentCode += normalTypingSection[i];
        setDisplayedCode(currentCode);
        if (normalTypingSection[i] === '\n') {
          await new Promise(resolve => setTimeout(resolve, 500));
        } else {
          await new Promise(resolve => setTimeout(resolve, getRandomTypingDelay()));
        }
      }

      await new Promise(resolve => setTimeout(resolve, 500));

      setIsSubmitting(true);
      await new Promise(resolve => setTimeout(resolve, 3000));

      setIsSubmitting(false);
      setShowConfirmation(true);

      await new Promise(resolve => setTimeout(resolve, 7000));
      if (isMounted) {
        setDisplayedCode('');
        setShowConfirmation(false);
        setIsSubmitting(false);
      }

      setTimeout(() => {
        if (isMounted) animateCode();
      }, 1000);
    };

    animateCode();

    const cursorInterval = setInterval(() => {
      if (isMounted) setShowCursor(prev => !prev);
    }, 530);

    return () => {
      isMounted = false;
      clearInterval(cursorInterval);
    };
  }, [code, fastForwardSection, normalTypingSection]);

  const redKeywords = ['import', 'from', 'const', 'await', 'new',`console`];
  const highlightedKeywords = ['Lucid','pay.ToAddress', 'sign.withWallet','selectWallet.fromPrivateKey'];

  const allKeywords = [...redKeywords, ...highlightedKeywords];
  const keywordRegex = new RegExp(`\\b(${allKeywords.join('|')})\\b`, 'g');

const LoadingSpinner = () => (
  <div style={{ display: 'inline-block', marginLeft: '10px' }}>
    <style jsx>{`
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `}</style>
    <div style={{
      border: '2px solid transparent',
      borderTop: '2px solid #4ec9b0',
      borderRadius: '50%',
      width: '16px',
      height: '16px',
      animation: 'spin 2s linear infinite', // Increased duration for smoother animation
    }}></div>
  </div>
);

  const SuccessIcon = () => (
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ marginRight: '8px' }}>
      <circle cx="8" cy="8" r="7" stroke="#4ec9b0" strokeWidth="2"/>
      <path d="M5 8L7 10L11 6" stroke="#4ec9b0" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
    </svg>
  );

  return (
    <div style={{
      position: 'relative',
      height: componentHeight,
      overflow: 'hidden',
      borderRadius: '8px',
      fontFamily: 'Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace',
      boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)',
    }}>
      {/* IDE-like header */}
      <div style={{
        backgroundColor: '#2d2d2d',
        padding: '8px 16px',
        height: headerHeight,
        borderTopLeftRadius: '8px',
        borderTopRightRadius: '8px',
        display: 'flex',
        alignItems: 'center',
      }}>
        <div style={{
          width: '12px',
          height: '12px',
          borderRadius: '50%',
          backgroundColor: '#ff5f56',
          marginRight: '6px',
        }}></div>
        <div style={{
          width: '12px',
          height: '12px',
          borderRadius: '50%',
          backgroundColor: '#ffbd2e',
          marginRight: '6px',
        }}></div>
        <div style={{
          width: '12px',
          height: '12px',
          borderRadius: '50%',
          backgroundColor: '#27c93f',
          marginRight: '12px',
        }}></div>
        <span style={{ color: '#fff', fontSize: '14px' }}>make_payment.ts</span>
      </div>

      {/* Code content */}
      <div style={{
        position: 'relative',
        backgroundColor: '#1e1e1e',
        height: `calc(100% - ${headerHeight})`,
      }}>
        <pre
          style={{
            backgroundColor: "transparent",
            height: codeHeight,
            overflow: "hidden",
            margin: 0,
            padding: '16px',
          }}
        >
          <code style={{
            whiteSpace: "pre-wrap",
            wordBreak: "break-all",
            overflowWrap: "break-word",
            display: "block",
            lineHeight: `${lineHeight}em`,
          }}>
            {displayedCode.split('\n').map((line, lineIndex) => (
              <div key={lineIndex} style={{ display: 'flex', flexWrap: 'wrap' }}>
                {line.split(keywordRegex).map((part, partIndex) => {
                  let style = {};
                  if (redKeywords.includes(part)) {
                    style.color = "#ff6b6b";
                  } else if (highlightedKeywords.includes(part)) {
                    style.color = "#87CEEB";
                  }
                  return <span key={partIndex} style={style}>{part}</span>;
                })}
                {lineIndex === displayedCode.split('\n').length - 1 && 
                  <span style={{
                    borderLeft: showCursor ? '2px solid #fff' : 'none',
                    marginLeft: '2px',
                    animation: 'blink 0.7s infinite',
                  }}>&nbsp;</span>
                }
              </div>
            ))}
          </code>
        </pre>
        <div
          style={{
            position: 'absolute',
            bottom: 0,
            left: 0,
            right: 0,
            padding: '12px 16px',
            backgroundColor: '#2d2d2d',
            borderBottomLeftRadius: '8px',
            borderBottomRightRadius: '8px',
            fontFamily: 'Consolas, Monaco, "Andale Mono", "Ubuntu Mono", monospace',
            fontSize: '14px',
            height: terminalHeight,
            overflow: 'hidden',
            display: 'flex',
            flexDirection: 'column',
            justifyContent: 'center',
          }}
        >
          <div style={{ color: '#b3b3b3', marginBottom: '8px', display: 'flex', alignItems: 'center' }}>
            <span style={{ color: '#4ec9b0', marginRight: '8px' }}>‚ùØ</span>
            <span style={{ color: '#569cd6' }}>run</span>
            <span style={{ marginLeft: '8px' }}>make_payment.ts</span>
            {isSubmitting && <LoadingSpinner />}
          </div>
          {showConfirmation && (
            <>
              <div style={{ color: '#4ec9b0', fontWeight: 'bold', marginBottom: '4px', display: 'flex', alignItems: 'center' }}>
                <SuccessIcon />
                Transaction submitted successfully
              </div>
              <div style={{ color: '#b3b3b3' }}>
                Hash - Submitted Tx: <span style={{ color: '#ce9178' }}>[transaction_hash_placeholder]</span>
              </div>
            </>
          )}
        </div>
      </div>
    </div>
  );
}

export function FAQBox({ title, children }) {
  return (
    <details
      open
      className="last-of-type:mb-0 rounded-lg bg-neutral-50 dark:bg-neutral-800 p-2 mt-4"
    >
      <summary>
        <strong className="text-lg">{title}</strong>
      </summary>
      <div className="nx-p-2">{children}</div>
    </details>
  );
}

<style jsx global>{`
  .fade-in {
    animation: fadeIn 0.85s ease-in;
  }
  .fade-in-delayed {
    animation: fadeIn 0.85s ease-in 1s;
    opacity: 0;
    animation-fill-mode: forwards;
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }
`}</style>

<div style={{ marginBottom: "6rem" }}></div>

![](/lucid-evolution-red-icon.png)

<div className="fade-in">
  <Hero
    title="Lucid Evolution"
    subtitle="An advanced off-chain framework for Cardano and an upgraded version of the legacy Lucid library"
    ctaText="Get Started"
    ctaLink="/install"
    ctaText2="Documentation"
    ctaLink2="/documentation/core-concepts/instantiate-evolution"
  />
</div>

<div style={{ marginBottom: "4rem" }}></div>

<div style={{ marginTop: "4rem" }}>
<AnimatedCode code={
  `import { Lucid } from "@lucid-evolution/lucid";
import { Blockfrost } from '@lucid-evolution/provider';
 
const lucid = await Lucid(
  new Blockfrost("https://cardano-preprod.blockfrost.io/api/v0", "<projectId>"),
  "Preprod"
);
 
lucid.selectWallet.fromPrivateKey(privateKey);
 
const tx = await lucid
  .newTx()
  .pay.ToAddress("addr_testa...", { lovelace: 5000000n })
  .pay.ToAddress("addr_testb...", { lovelace: 5000000n })
  .complete();
 
const signedTx = await tx.sign.withWallet().complete();
const txHash = await signedTx.submit();
console.log("Hash - Submitted Tx:", txHash);`
} 
 />

</div>

<div style={{ marginBottom: "4rem" }}></div>

# Why Evolution?

---

<div style={{ marginBottom: "2.5rem" }}></div>

<Tabs
  items={[
    "Improved APIs",
    "Enhanced Error Handling",
    "Refined Structure",
    "Latest CML",
    "Developer-Centric",
  ]}
>
  <Tabs.Tab>
    Enhanced interfaces for better developer experience, streamlined function
    calls for common operations. Take advantage of built-in support for popular
    Cardano features, reducing the need for external dependencies
  </Tabs.Tab>
  <Tabs.Tab>
    Error management just got better and a lot smoother with our integration of
    the Effect library. Debug quicker with detailed, context-rich error
    messages. Handle exceptions easily with our structured error types
  </Tabs.Tab>
  <Tabs.Tab>
    Lucid Evolution uses a modular code architecture. The codebase separates
    functionality into distinct packages. Many components are designed for
    reusability across different parts of the library. We will be able to add
    new features as separate modules within the existing architecture
  </Tabs.Tab>
  <Tabs.Tab>
    Keeping up with the latest version of the [Cardano Multi-platform Library (CML)]("https://dcspark.github.io/cardano-multiplatform-lib/")

  </Tabs.Tab>
  <Tabs.Tab>
    Documentation for Lucid Evolution includes code examples for various use
    cases. The project maintains a public GitHub repository for issue tracking
    and discussions. Regular updates are published to address bugs and add
    features. We mostly provide support through GitHub issues and our dedicated
    [Discord channel]("https://discord.gg/s89P9gpEff")
  </Tabs.Tab>
</Tabs>

<div style={{ marginBottom: "6rem" }}></div>

# Quickstart

---

<Steps>
### Set up your project
Initialize a new TypeScript project

### Install the packages you need

<Cards>
  <Cards.Card title="Lucid Evolution packages" href="/install" />
</Cards>

### Build and submit a transaction

---

<Steps>
‚Üí **Instantiate Lucid Evolution** and choose a provider
<Cards>
  <Cards.Card
    title = "Core Concept 1: Instantiation"
    href = "/documentation/core-concepts/instantiate-evolution"
  />
</Cards>

‚Üí **Choose a wallet** and select it

<Cards>
  <Cards.Card
    title="Core Concept 2: Choose wallet"
    href="/documentation/core-concepts/create-choose-wallet"
  />
</Cards>

‚Üí **Build your first transaction** and submit it

<Cards>
  <Cards.Card
    title="Core Concept 3: Your first transaction"
    href="/documentation/core-concepts/first-transaction"
  />
</Cards>

‚Üí **Learn more** about advanced concepts and start building

<Cards>
  <Cards.Card
    icon = "ü•Ω"
    title = " Deep Dive Series"
    href = "/documentation/deep-dives/make-payments"
  />
</Cards>
</Steps>
</Steps>

<div style={{ marginBottom: "6rem" }}></div>

# F.A.Q.

---

<div style={{ marginBottom: "3rem" }}></div>

<FAQBox title="What is Lucid Evolution?">
  Lucid Evolution is an off-chain framework library for Cardano, designed to
  facilitate the development of decentralized applications (dApps). It includes
  various packages such as utilities for signing data, Plutus integration, and
  wallet management, all built using TypeScript to enhance type safety and
  developer experience
</FAQBox>

<FAQBox title="How does Lucid Evolution ensure compatibility with Cardano's evolving scene?">
  Lucid Evolution is actively maintained to ensure compatibility with Cardano's
  protocols and upcoming hard forks like Chang. We are actively involved in
  updating our fee models, and functionalities to support upcoming changes. We
  like to emphasize regular updates and community contributions to address any
  compatibility issues and enhance functionality
</FAQBox>

<FAQBox title="Can I contribute to the development of Lucid Evolution?">
  Yes, contributions to Lucid Evolution are welcome. You can submit issues,
  feature requests, or pull requests on the project's GitHub repository to help
  improve the library and its documentation
</FAQBox>
